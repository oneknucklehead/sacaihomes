{% comment %}
  Product Carousel Section
  Uses Slick Carousel + TailwindCSS
  Displays a row of products with prev/next arrows on ends.
{% endcomment %}

<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.css"
>
<link
  rel="stylesheet"
  href="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick-theme.min.css"
>

<div class="product-carousel-section bg-white py-10">
  <div class="container mx-auto px-4">
    {% if section.settings.heading != blank %}
      <h2 class="text-2xl font-semibold mb-6 text-center">{{ section.settings.heading }}</h2>
    {% endif %}

    <div class="relative">
      <!-- Prev Button -->
      <button
        type="button"
        class="slick-prev absolute -left-8 top-1/2 transform -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full w-10 h-10 flex items-center justify-center z-10"
      >
        ❮
      </button>

      <!-- Carousel -->
      <div class="product-carousel">
        {% for product in collections[section.settings.collection].products %}
          <div class="px-2">
            <div class="border rounded-lg overflow-hidden bg-white shadow-sm hover:shadow-md transition">
              <a href="{{ product.url }}" class="block">
                <img
                  src="{{ product.featured_image | img_url: '400x400' }}"
                  alt="{{ product.title }}"
                  class="w-full h-64 object-cover"
                >
                <div class="p-4 text-center">
                  <h3 class="text-base font-medium">{{ product.title }}</h3>
                  <p class="text-gray-700 mt-1">{{ product.price | money }}</p>
                </div>
              </a>
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Next Button -->
      <button
        type="button"
        class="slick-next absolute -right-8 top-1/2 transform -translate-y-1/2 bg-gray-200 hover:bg-gray-300 text-gray-700 rounded-full w-10 h-10 flex items-center justify-center z-10"
      >
        ❯
      </button>
    </div>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" defer></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/slick-carousel/1.8.1/slick.min.js" defer></script>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const $carousel = $('.product-carousel');

    $carousel.slick({
      slidesToShow: 3,
      slidesToScroll: 1,
      infinite: true,
      arrows: true,
      prevArrow: $('.slick-prev'),
      nextArrow: $('.slick-next'),
      dots: false,
      responsive: [
        {
          breakpoint: 1024,
          settings: {
            slidesToShow: 2,
          },
        },
        {
          breakpoint: 640,
          settings: {
            slidesToShow: 1,
          },
        },
      ],
    });
  });
</script>

{% schema %}
{
  "name": "Product Carousel",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Featured Products"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Select Collection"
    }
  ],
  "presets": [
    {
      "name": "Product Carousel"
    }
  ]
}
{% endschema %}
